
mixin buttonlink(value,link)
	input(class='btn btn-default', type='button', value=value, onclick="window.location.href='"+link+"'")

mixin fieldset(fieldset)
	form(id="activeForm", ng-submit="sendForm()", name="$form")
		fieldset
			legend
				#{'h'+(3+locals.depth)}.text-primary=fieldset.title
					small=' '+fieldset.details

			div(class="form-horizontal")
				each field in fieldset.fields
					if field.template=='subset' || field.template=='list' 
						+#{field.template}(field)
					else
						+field(field)

mixin subset(subset)
	fieldset.pillar-subset
		legend
			#{'h'+(3+subset.depth)}.text-primary=subset.label
				small=' '+subset.details
		each field in subset.fields
			+field(field)

mixin list(list)
	.form-group
		label(class="control-label col-sm-2")=list.label
		div(class="list-container container col-sm-10")
			p(class="help-block")=list.details
			fieldset(ng-repeat="($lk"+list.depth+", $lf"+list.depth+") in "+list.fieldset.NgScope+"."+list.id)
				legend
					#{'h'+(3+list.depth)}.text-primary
						= list.items.label
						small=' '+list.items.details
				each field in list.fields
					+field(field)
			
			input(class='btn btn-primary', type='button', value='Add',ng-click="addListItem("+list.fieldset.NgScope+",'"+list.id+"')")

mixin field(field)
	- var ngExp = field.NgExp;
	div(class="form-group", ng-class="{'has-error':validations['"+ngExp+"']}")
		label(class="control-label col-sm-2",for=field.NgId)=field.label

		if field.i18n
			+field-i18n(field)
		else
			div(class="col-sm-10")
				+field-validation(field.NgExp)
				+#{field.template}({id:field.NgId,name:field.NgName,value:field.NgScope})
				p.help-block=field.details

mixin field-i18n(field)
	.pillar-langfields
		each lang in gw.textualization.langs
			- var classes = [];
			- classes.push('lang-'+lang);
			div(class="col-sm-10 ng-hide", ng-show="languages.active=='"+lang+"'")
				+field-validation(field.NgExp+"."+lang)
				+#{field.template}({id:field.NgId+"_"+lang,name:field.NgName+"["+lang+"]",value:field.NgScope+"."+lang,classes:classes})
				p.help-block=field.details

mixin field-validation(ngExp)
	div(class="alert alert-danger ng-hide",ng-show="validations['"+ngExp+"']")
		ul(class="list-unstyled")
			li(ng-repeat="msg in validations['"+ngExp+"']") {{msg}}

mixin text(config)
	input(type='text', class=config.classes, class=['form-control','field-text'], id=config.id, name=config.name, ng-model=config.value)

mixin file(config)
	input(type='file', class=config.classes, class=['form-control','field-file'], id=config.id, name=config.name)
	span="{{"+config.value+"}}"

mixin textarea(config)
	textarea(class=config.classes, class=['form-control','field-textarea'], id=config.id, name=config.name, ng-model=config.value)

